---
title:  "AIX系统ODM驱动程序"
tag: AIX, ODM, 驱动
---

AIX系统作为一个“古老”的Unix系统，如今伴随着IBM公司的Power系列小型机依旧存在于众多银行、电信公司以及其他大型企业的数据中心。虽然其江湖地位不如从前，但其他设备厂商仍不舍得放弃对AIX的支持。而ODM驱动程序是对其支持的必要条件。

## 什么是ODM？
ODM（Object Data Manager），顾名思义就是管理系统对象数据的系统工具。我们熟悉的Windows系统中，有个叫注册表（Register）的部件，存有许多系统和软件的相关配置，ODM大体可以理解为AIX系统的“注册表”。
AIX系统中的ODM主要存储两大类：
- 设备（网卡、HBA卡、磁带、硬盘等）及其配置信息
- 软件（3rd part、SMIT工具）及其配置信息

详细的介绍可以参照这篇博文[AIX ODM 简介](https://www.ibm.com/developerworks/cn/aix/library/1105_chenwei_odm/).


## AIX为什么有ODM？
先说类似的Windows的注册表，学生时代，有过一行修改注册表的CMD命令修好同学电脑时的自豪感，也有过改错了注册表系统被迫重装的尴尬境地。Windows作为大众玩家的系统，大家对注册表的诟病颇多，因为其不像Linux一样，可以轻松编辑配置文件。软件安装或者卸载过程中出现问题，难以解决。

既然Windows的注册表是问题颇多的，那AIX为什么会一直采用这样的ODM系统呢？其原因大概有：

- AIX是商用系统，会对底层的信息做一些屏蔽，
- 运维人员都是专业技术人员，一般不至于因为错误修改ODM而导致系统崩溃，
- 屏蔽软件的配置过程，更有利于安全地使用，
- 集中存放配置信息，读取更加高效。

不过在其他商用的Unix/Linux系统中，例如HP-UX、Solaris、RHEL、SLES中都没有像这样的集中式系统及软件配置系统。大多数系统还是分散的配置文件形式。

而到底是集中配置系统好，还是分散的自由配置文件好，恐怕又会上升到“集中式--分布式之争”。


## ODM具体存在形式及相关操作

ODM以二进制文件的方式存在于：
- `/etc/objrepos`： 主要包含`Cu*`类的文件，其`Pd*`类为`/usr/lib/objrepos/Pd*`类的软链接
- `/usr/lib/objrepos`：主要包含预定义的`Pd*`类文件
- `/usr/share/lib/objrepos`：仅包含软件相关信息（SWVPD）

主要的对象文件：
- PdDv：设备类别定义
- PdAt：某一设备类别的相关参数定义
- CuDv：具体某一设备
- CuAt：具体某一设备的相关参数值

ODM文件内容为Stanza样式，如：
```
PdAt:
        uniquetype = "logical_volume/vgsubclass/vgtype"
        attribute = "quorum"
        deflt = "y"
        values = ""
        width = ""
        type = "R"
        generic = ""
        rep = "sl"
        nls_index = 0
```
相关操作命令：
- 查询：`odmget -q "name=hdisk0" CuDv`
- 删除：`odmget -q "name=hdisk11" -o CuAt`
- 增加：`odmadd /odmadd/file/path`


## ODM开发中的主要部分介绍
- 不同file功能
- 参数接口设定



## Reference
[1] IBM Knowledge Center, Offical,  [https://www.ibm.com/support/knowledgecenter/ssw_aix_72/generalprogramming/odm.html](https://www.ibm.com/support/knowledgecenter/ssw_aix_72/generalprogramming/odm.html)  
[2] AIX for System Administrators, Blog,  [http://aix4admins.blogspot.com/2011/08/odm-object-data-manager-it-is-database.html](http://aix4admins.blogspot.com/2011/08/odm-object-data-manager-it-is-database.html)  
[3] Understanding the AIX Object Data Manager, Training, www.globalknowledge.com  
[4] General Programming Concepts: Writing and Debugging Programs, Book.
